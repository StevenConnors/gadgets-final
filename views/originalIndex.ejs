<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.0.0/Chart.js"></script>
    <script>

    </script>
  </head>
  <body>
    <h1><%= title %></h1>
    <p>Welcome to <%= title %></p>
    <h3 id='piezoValA'>A </h3> <h3 id="piezoAvgA"> </h3>
    <h3 id='piezoValB'>B </h3> <h3 id="piezoAvgB"> </h3>
    <h3 id='piezoValC'>C </h3> <h3 id="piezoAvgC"> </h3>


    <script type="text/javascript">
    // window.location = "http://www.cmu.edu";


      var socket = io.connect();
      var allVals = [0, 0, 0];


      socket.on('sensorA', function (data) {
        // data.sensorVal is in the form X: ###
        document.getElementById("piezoAvgA").innerHTML = data.num;
        allVals[0] = data.num;
        checkAllVals();
      });

      socket.on('sensorB', function (data) {
        document.getElementById("piezoAvgB").innerHTML = data.num;
        allVals[1] = data.num;
      });

      socket.on('sensorC', function (data) {
        document.getElementById("piezoAvgC").innerHTML = data.num;
        allVals[2] = data.num;
      });


      var alerted = false;
      var threshold = 300;

      var checkAllVals = function () {
        var tappedA = allVals[0] > threshold;
        var tappedB = allVals[1] > threshold;
        var tappedC = allVals[2] > threshold;

        if (!alerted) {
          if (tappedA || tappedB || tappedC) {
            alert("A:" +tappedA +"\n B:" + tappedB + "\n C:" +tappedC);
            alerted = true;
          }
        } else {
          if (!tappedA && !tappedB && !tappedC) {
            alerted = false;
          }
        }
      }


    </script>
  </body>
</html>
